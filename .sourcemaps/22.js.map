{"version":3,"sources":["../../src/pages/painel-controle-adm/painel-controle-adm/grupo-usuario/grupo-usuario.module.ts","../../src/pages/painel-controle-adm/painel-controle-adm/grupo-usuario/grupo-usuario.ts"],"names":[],"mappings":"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","file":"22.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { GrupoUsuarioPage } from './grupo-usuario';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    GrupoUsuarioPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(GrupoUsuarioPage),\r\n  ],\r\n})\r\nexport class GrupoUsuarioPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/painel-controle-adm/painel-controle-adm/grupo-usuario/grupo-usuario.module.ts","import { PerfilUsuario } from './../../../../providers/database/models/perfil-usuario';\r\nimport { PerfilAcesso } from './../../../../providers/database/models/perfil-acesso';\r\nimport { PerfilAcessoService } from './../../../../providers/database/services/perfil-acesso';\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, AlertController, ToastController, ModalController } from 'ionic-angular';\r\nimport { UsuarioService } from '../../../../providers/database/services/usuario';\r\nimport { Usuario } from '../../../../providers/database/models/usuario';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-grupo-usuario',\r\n  templateUrl: 'grupo-usuario.html',\r\n})\r\nexport class GrupoUsuarioPage {\r\n  perfisUsuarios: any[] = [];\r\n  perfis: PerfilAcesso[]\r\n  constructor(\r\n    public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    public perfilAcessoSrvc: PerfilAcessoService,\r\n    public usuarioSrvc: UsuarioService,\r\n    public alertCtrl: AlertController,\r\n    public toastCtrl: ToastController,\r\n    public modalCtrl: ModalController\r\n  ) {\r\n    this.refresh();\r\n  }\r\n\r\n  refresh() {\r\n    this.perfisUsuarios = [];\r\n    this.usuarioSrvc.usuarios.take(1).subscribe((usuarios: Usuario[]) => {\r\n      this.perfilAcessoSrvc.perfisAcesso.take(1).subscribe((perfis: PerfilAcesso[]) => perfis\r\n        .filter(x => x.per_ativo && !x.per_padrao && !x.per_distribuidor)\r\n        .map(perfil => {\r\n          let perfilUsuario: any = perfil;\r\n          perfilUsuario.per_usuarios = usuarios.filter(x => (<any>Object).keys(x.usr_perfis).filter(key => key == perfil.$key).length > 0);\r\n          this.perfisUsuarios.push(perfilUsuario);\r\n        })\r\n      )\r\n    })\r\n  }\r\n\r\n  excluiPerfil(perfil, usuario) {\r\n    let confirm = this.alertCtrl.create({\r\n      title: 'Confirma exclusão',\r\n      message: 'Deseja realmente excluir o usuário do grupo?',\r\n      buttons: [\r\n        {\r\n          text: 'Não',\r\n        },\r\n        {\r\n          text: 'Sim',\r\n          handler: () => {\r\n            this.usuarioSrvc.excluirPerfil(usuario.$key, perfil.$key).then(() => {\r\n              this.refresh();\r\n            });\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    confirm.present();\r\n  }\r\n\r\n  selecionarUsuario(perfil) {\r\n    let usuariosLista: Usuario[] = [];\r\n    this.usuarioSrvc.usuarios.take(1).subscribe((usuarios: Usuario[]) => {\r\n      usuariosLista = usuarios.filter(x => (<any>Object).keys(x.usr_perfis).filter(key => key == perfil.$key).length == 0);\r\n      if (usuariosLista.length == 0) {\r\n        let toast = this.toastCtrl.create({\r\n          message: 'Todas as usuarios foram adicionadas.',\r\n          duration: 3000,\r\n          position: 'top'\r\n        });\r\n        toast.present()\r\n      } else {\r\n        let modal = this.modalCtrl.create('SelectUsuarioPage', { usuarios: usuarios });\r\n        modal.present();\r\n        modal.onDidDismiss(data => {\r\n          if (data)\r\n            if (data.usuariosSelecionados) {\r\n              data.usuariosSelecionados.forEach((usuario: Usuario) => {\r\n                this.usuarioSrvc.addPerfil(usuario.$key, perfil.$key).then(()=>{\r\n                  this.refresh();\r\n                })\r\n              });\r\n            }\r\n        })\r\n      }\r\n    })\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/painel-controle-adm/painel-controle-adm/grupo-usuario/grupo-usuario.ts"],"sourceRoot":""}